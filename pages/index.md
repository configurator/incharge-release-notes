# InCharge Release notes

מסמך זה יפרט את הפיצ'רים החדשים ששוחררו בכל גירסא של אינצ'ארג'

המסמך מדבר על כל הסוגים השונים של אינצ'ארג', ולא מפריד בין מצבי העבודה השונים

# v2.4 - 1/8/2023

גרסה זו מכילה מספר פיתוחים חדשים: 

* הגרסה מכילה תמיכה ביצירת מספרי Z מול וריפון והעברתם עבור כל עסקה. מעקב אחר המספרים קורה באופן עצמאי על ידי InCharge, שיוצרת מספרי Z חדשים מול וריפון בעת הצורך ומעבירה אותם לוריפון בעת יצירת חשבונית. יצירת דוחות Z עבור וריפון מותנת באופציה חדשה בקונפיג, בשם ״createVerifoneZReport״, אשר מכילה ערך בוליאני. 
* תמיכה בשליחת SMS ע״י שמיר - תהליך השליחה זהה לחלוטין לתהליך העבודה מול Telemesser. התהליך דורש מספר הגדרות קונפיג חדשות בקוד. להלן:
"smsVendor" - "shamir" (ספק הסמסים. טלמסר באופן ברירת מחדל)
"smsSenderName" - שם השולח
"shamirUsername" - שם המשתמש של היוזר מול שמיר
"shamirAuthToken" - הטוקן (לא סיסמה!) של היוזר מול שמיר
* תצורת InCharge Food - תמיכה בקבוצות אופציות המכילות הגדרות אישיות לקבוצה, כגון כמות אופציות מקסימלית לכל קטגוריה, ובחירת אופציות בתשלום.
* תמיכה בניהול כמויות סחורה מול קטלוגים הנשמרים על ידי InCharge באופן פנימי, הצגת מוצרים זמינים בהתאם לחנויות, והנמכת כמויות סחורה עבור כל מוצר בעת קנייה.

# v2.3 - 26/7/2023

גרסה זו מכילה מספר פיתוחים חדשים, תיקוני באגים מהותיים, ושינוי אופן ההדפסה

### הדפסה
תהליך ההדפסה כעת מנוהל באופן נפרד מהאפליקציה, על ידי process חדש ייעודי לניהול הדפסה. הprocess נפתח ע״י האפליקציה עבור כל בקשת הדפסה, מדפיס את המידע שהתבקש מהאפליקציה, ונסגר. בעזרת שינוי זה, אנחנו נמנעים מתקלות העולות מתעבורת בקשות הדפסה גדולה. אנחנו מאמינים ששינוי זה יסייע למנוע את תקלת חוסר התקשורת מצד המדפסת.

### פיתוחים
* ניהול ספרור Z באופן פנימי - על בסיסו מפותחת תמיכה בניהול דוחות Z מול וריפון
* שיפור לוגים עבור הP400
* העברת ביצוע end of day אוטומטי על ידי האפליקציה ל05:00 במקום 04:00
* שינוי אופן יצירת וניהול התאריך והשעה הנשלחים למסופון ומעבר לUTC 0 במקום UTC+3
* קריאת קובץ צימוד מסופון באופן דינמי ממספר מקומות אפשריים, בסדר הבא:
1. C:/incharge/MXTester/sec.db
2. C:/MXTester/sec.db
3. C:/incharge/sec.db

### תיקוני באגים
* תיקון באג - קריסה בעת מעבר לתשלום כאשר אופציית ״נגישות״ פעילה
* תיקון באג - אי סגירת עסקת נקודות
* תיקון באג - אי סגירת עסקה מול מסופון עם firmware לא עדכני, בגרסה 3.4.4 ומטה
* תיקון באג - אי שליחת קבלה ירוקה
* שיפור ניהול שגיאות - תקלה בעת ניסיון שליחת סמס


# v2.2 - 17/7/2023 
גרסה זו מכילה מספר שינויים ארכיטקטורים, שינויים ותיקונים משניים, ותיקוני באגים:

### שינויים ארכיטקטורים:
* שינוי ארכיטקטורי מהותי לאופן ההדפסה - ניהול תהליכי ההדפסה דרך process נפרד מהאפליקציה שמתאפס בין כל הדפסה
* שינוי ארכיטקטורי לדף אי פעילות - פיצול דף אי פעילות לדף שגיאה (אליו מגיעים רק במצבי שגיאה מהותית) ודף אי-פעילות (אליו האפליקציה עוברת באופן אוטומטי לפי הגדרות קונפיג)
* שינוי ארכיטקטורי לניהול אמצעי תשלום והוספת תשתית לפיתוחים עתידיים - גישה לדף אמצעי תשלום מתבצעת באופן אוטומטי, ואמצעי התשלום הזמינים למשתמש מופיעים באופן המותנה בהגדרות המכונה ובעסקה העכשווית (לדוגמה - האם המשתמש עונה על דרישות החנות לבחירת תשלומים - במידה ולא, האופציה תוסתר)

### שינויים משניים:
* הוספת ניהול-שגיאות (error-handling) חסר למתודות סמסים ויצירת חשבונית פנימית
* הוספת אופציה לקבלת סמסים מכל עמדה בעת שגיאות חמורות, נסיונות ביצוע עסקה ועסקאות מוצלחות
* שינוי אופן יצירת ברקודים בהוצאת פתקי ברקוד (Invendiv) על מנת לתמוך בקניית מוצרים מרובה
* הוספת קוד מוצר לפתקי ברקוד (Invendiv)
* הוספת טעינת תמונות אוטומטית (preloading) לקטלוג מוצרים פנימי באופן דינמי
* תיקונים ויזואלים בתצוגת קטלוג חדשה (Invendiv, Analyza)

### תיקוני באגים: 
* תיקון באג - קריסה בעת יצירת חשבונית עקב פרמטרים חסרים בעת קריאה למתודה
* תיקון באג - קריסה בעת קבלת סירוב מהמסופון עקב קבלת תשובה שונה מהמצופה

# v2.1 - 10/7/2023

גרסה זו מכילה מספר תיקונים מינוריים, בהתאם ללוחות הזמנים שנקבעו בTeamwork:

* Console: shut down screen graphics
* Console: shut down machine, turn on machine
* Add payment types screen: "how do you want to pay?" 
* Add creditTerminalNo to CreateInvoice 
* Print in receipt: how many points the user accumulated
* Disable history (on swipe)

# v2.0 - 4/7/2023

גירסא זו היא גירסא ראשית. בגירסא זו הוספנו את היכולת להגדיר עמדות מרחוק, הכולל console, הנותן שליטה על כולל פורטים שניגשים אליהם, טקסטים שמופיעים במערכת, תמונות אווירה, וכל הגדרות המערכת. 

## גירסא זו כוללת

### קונפיגורציה מרחוק

החל מהיום, הקונפיגורציה של העמדות נטענת מהשרתים שלנו ומנוהלת מרחוק.

השליטה בקונפיגורציה מתבצעת כרגע על ידי עובדי אינצ'ארג', ונקבעה שיחה ל 11/7 על מנת לתת הסבר וגישה לעמית ולדימה.
בהמשך ממשק זה יאופשר גם למנהלי הרשתות והקבוצות.

הממשק שולט בכל האספקטים של המערכת, מלבד התקנת גירסא, בין השאר:
* באיזה מצב המערכת עובדת - ריטייל, מזון, או מכונות ממכר
* כל תמונות וסרטוני האווירה במערכת
* טקסטים שמופיעים במערכת
* כתובות של ממשקים
* איזה מערכות ומודולים מופעלים במערכת

כאשר מבצעים שינוי בממשק, הוא מתעדכן מיד בעמדה הרלוונטית.

### מודולריזציה

כל תשתית המערכת עברה refactor שאיחד מסכים שונים שעושים דברים זהים, ונבנתה מערכת מודולים נרחבת.

שינוי זה מאפשר הכנסת מצבים ופיצ'רים חדשים בקלות, ללא התנגדות עם פיצ'רים קיימים של המערכת. כך לדוגמא יכולנו להכניס את מצב המערכת של מכונות הממכר (invendiv)

### שינויי תקשורת

שינינו את דרכי התקשורת של המערכת. לכל שרת חיצוני, יש אפשרות להפעיל או לכבות את הפרוקסי, בהתאם לתנאי הרשת של הלקוח.

### יציבות מערכת

בגירסא זו נכנסו מספר שינויים לטובת יציבות המערכת:

* קבלת התראות (על ידי צוות אינצ'ארג') כאשר יש תקלה בשרתים
* התאוששות כאשר יש ניתוק רשת במהלך עסקה
* התאוששות כאשר יש ניתוק חשמל במהלך עסקה
* טיפול בתקלות המגיעות מה APG

### אינטגרציות

* WiseSense: שליחת קוד RFID לקופה בעת סגירת חשבונית
* WiseSense: תמיכה בקבלת מספר מוצרים בסריקה אחת
* Verifone: תמיכה במועדון לקוחות פנימי של וריפון

### קופה עצמאית

הוספנו תמיכה ביצירת חשבוניות ודוחות Z פנימיים של הקופה, למקרים שבהם אין צורך באינטגרציה לקופה חיצונית.

### מבצעים

הוספנו תמיכה במבצעים:

* מבצע 4
* מבצע 18
* מבצע 19
* מבצע 20
* חסימת פריטים במערכת (קבוצה 9)

### בקשות מלקוחות

* בחירת מוכרן - עכשיו יש אפשרות להגדיר שהבחירה תהיה רק מתוך העובדים שכרגע במשמרת
* שפת מערכת - בסיום עסקה, המערכת תחזור לשפת ברירת מחדל
* מנגנון תשלומים
    * מסך התשלומים לא מוצג כשלא מגיעים למינימום עבור 2 תשלומים, ומוצגת התראה בהתאם
    * כאשר מנסים להשתמש ביותר תשלומים מהמגבלה, תוצג הודעה מתאימה
* שינויים במסך ביקורת מנהל לבקשת פוקס
* אוסף שינויים קטנים שזארה ביקשו
* חץ מצביע לכיוון מסוף האשראי, הכיוון ניתן לשליטה מהקונפיג
* אפשרות לקבל עותק חשבונית מודפס בנוסף למקור ב SMS
* הדפסת מספר נקודות קרדיט שיש ללקוח בסיום עסקה
    * הערה: לא מודפס כמה נקודות נצברו בעסקה, שכן אנחנו לא מקבלים את הנתון מוריפון
* הוספת מסך אמצעי תשלום (אפשרויות כרגע: אשראי רגיל או תשלומים)

### תיקוני תקלות

* טיפול בתקלה ב H&M שבגללה מסך תשלומים לא הוצג בכל העסקאות
* תיקון תקלות במועדון לקוחות פנימי שדווחו על ידי זארה
* תיקונים במסך ביקורת מנהל

### רשימת משימות מה Teamwork

רשימה זו מתמצתת את רשימת השינויים, לפי שמות הטיקטים ב Teamwork:

* Send RFID code (from WiseSense) in CreateInvoice
* Select seller - only show sellers currently in shift
* P400 certification - התאוששות מאסון
* Seller selection (בחירות מוכרן)
* מבצע 18
* מבצע 19
* Zara - requested changes & תיאום משימות מחדש
* מועדון לקוחות וריפון
* P400 - Retry on code 10
* מבצע 20 - חסימת עמדה
* שפת מערכת: בסיום עסקה לחזור לשפת ב"מ המחדל שמופיע בקונפיג
* מנגנון תשלומים - לא להציג כשלא מגיעים לרף
* מנגנון תשלומים - הודעה על סכום מינימום
* Create `standalone` service with one api functionality - `/api/createOrder` which saves the order to RavenDB
* מבצע 4 - הדפסת מסר
* Change password for ביקורת מנהל
* Config options to enable/disable proxy for (1) defacto calls and (2) R360 calls
* Minor bugs in הטבות מועדון לקוחות פנימי
* חסימת פריט למכירה
* H&M - באג תשלומים
* חסימת פריט למכירה
* Re-add arrow config option and add arrow-direction config options
* Support receiving multiple products from WiseSense
* Fetch config from database
* CreateInternalInvoice
* ManagerReview fixes
* Receipt option "both"
* Fox - Verifone requests Proxy fix
* להדפיס בחשבונית כמה נקודות קרדיט הלקוח צבר וכמה יש לו
* Upgrade and config all fox stations
* Add payment types screen: "how do you want to pay?"
* Seller selection: only show sellers in current shift
* התראות לגבי תקלות בצד של INCHARGE
